<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Rozgrywki młodzieżowe – terminarze i rankingi</title>
<style>
  :root{
    --blue:#0d3b66; --gold:#c9a227; --bg:#f2f5f9;
    --row:#fff; --row-alt:#f7f8fa; --muted:#6b7280;
    --text:#111827; --border:#e8edf3;
  }
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text);}
  header{background:var(--blue);color:#fff;padding:18px 16px;box-shadow:0 2px 8px rgba(0,0,0,.08);}
  header .wrap{max-width:1200px;margin:0 auto;} h1{margin:0;font-size:clamp(18px,2.3vw,24px);font-weight:700;}
  .container{max-width:1200px;margin:24px auto;padding:0 16px;}
  .tabs{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:16px}
  .tab-btn{border:1px solid var(--border); background:#fff; color:#0d3b66; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:700;}
  .tab-btn.active{background:linear-gradient(180deg,#114676 0%, #0d3b66 100%); color:#fff; border-color:#0d3b66}
  .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:16px}
  @media (max-width:900px){ .grid{grid-template-columns:1fr;} }
  .card{background:#fff; border:1px solid var(--border); border-radius:12px; box-shadow:0 6px 18px rgba(13,59,102,.08); overflow:hidden;}
  .card-header{background:linear-gradient(180deg,#114676 0%, #0d3b66 100%); color:#fff; padding:12px 14px; border-bottom:3px solid var(--gold); display:flex; align-items:center; justify-content:space-between;}
  .card-header h2{margin:0;font-size:16px}
  .card-body{padding:12px 14px}
  .table-wrap{overflow-x:auto}
  table{width:100%; border-collapse:collapse; min-width:700px}
  thead th{background:var(--blue); color:#fff; padding:9px 8px; text-align:center}
  tbody td{padding:9px 8px; text-align:center; border-bottom:1px solid var(--border); background:#fff}
  tbody tr:nth-child(even) td{background:var(--row-alt)}
  td.left{text-align:left}
  .muted{color:var(--muted)}
  .chip{display:inline-block;padding:4px 8px;border-radius:999px;font-size:12px;font-weight:700}
  .chip-upcoming{background:#eef2ff;color:#1e3a8a;border:1px solid #c7d2fe}
  .chip-played{background:#ecfdf5;color:#065f46;border:1px solid #a7f3d0}
  tr.row-upcoming td{background:#f8fafc !important}
  tr.row-played td{background:#f0fdf4 !important}
</style>
</head>
<body>
<header><div class="wrap"><h1>Rozgrywki młodzieżowe – terminarze i rankingi</h1></div></header>

<main class="container">
  <div class="tabs">
    <button class="tab-btn active" data-view="m_rozstaw1">Młodzik – Rozstaw I</button>
    <button class="tab-btn" data-view="m_rozstaw2">Młodzik – Rozstaw II</button>
    <button class="tab-btn" data-view="m_liga">Młodzik – Liga</button>
    <button class="tab-btn" data-view="m_final">Młodzik – Finał</button>
    <button class="tab-btn" data-view="f_rozstaw1">Młodziczka – Rozstaw I</button>
    <button class="tab-btn" data-view="f_rozstaw2">Młodziczka – Rozstaw II</button>
    <button class="tab-btn" data-view="f_liga">Młodziczka – Liga</button>
    <button class="tab-btn" data-view="f_final">Młodziczka – Finał</button>
  </div>
  <div id="view"></div>
</main>

<script>
// <<< PODMIEŃ TYLKO TEN LINK >>>
const WEB_APP_URL_BASE = "https://script.google.com/macros/s/AKfycbwxcm10QSkzvs5uUX3RyRXL3xA5Ci01_bNyuLRjFxYYRIqUo3qE23lt9qwPks75IaXu/exec";
const WEB_APP_URL = "https://corsproxy.io/?" + encodeURIComponent(WEB_APP_URL_BASE + "?action=get&cb=" + Date.now());

// --- utils (formaty, daty, tabela, parseSets, computeTable, statusBadge itd.)
// [tutaj wklej cały dział utils i computeTable z Twojej działającej wersji]

// --- bonusy punktów klasyfikacyjnych ---
const BONUS_BY_KIND = { mlodzik: 16, mlodziczka: 42 };
function classificationBonus(place, maxBonus){ const val=maxBonus-(place-1); return val>=1?val:1; }

// --- renderRanking (z bonusami dla finałów) ---
function renderRanking(title, tableRows, opts = {}){
  const isFinal=!!opts.final;
  const maxBonus=Number(opts.maxBonus ?? BONUS_BY_KIND[opts.kind] ?? 0);
  let headers, rows;
  if(!isFinal){
    headers=['Miejsce','Drużyna','M','W','P','Sety (+/−)','Małe (+/−)','Punkty'];
    rows=tableRows.map((t,idx)=>[ idx+1,t.team,t.matches,t.wins,t.losses,`${t.setsFor}:${t.setsAgainst}`,`${t.smallFor}:${t.smallAgainst} (${t.smallFor-t.smallAgainst>=0?'+':''}${t.smallFor-t.smallAgainst})`,t.points ]);
  }else{
    headers=['Miejsce','Drużyna','M','W','P','Sety (+/−)','Małe (+/−)','Punkty meczowe','Klasyfikacyjne','Razem'];
    rows=tableRows.map((t,idx)=>{ const place=idx+1; const bonus=classificationBonus(place,maxBonus); const total=t.points+bonus;
      return [place,t.team,t.matches,t.wins,t.losses,`${t.setsFor}:${t.setsAgainst}`,`${t.smallFor}:${t.smallAgainst} (${t.smallFor-t.smallAgainst>=0?'+':''}${t.smallFor-t.smallAgainst})`,t.points,bonus,total]; });
  }
  return makeCard(title, makeTableEl(headers, rows));
}

// --- renderFinalView (używa bonusów: 16 dla młodzika, 42 dla młodziczki) ---
function renderFinalView(allRows, label){
  const view=document.createElement('div'); const grid=document.createElement('div'); grid.className='grid';
  const term=renderTermFinal(`${label} – Finał`, allRows);
  const table=computeTable(allRows);
  let rank;
  if(label==='Młodzik') rank=renderRanking(`Ranking – ${label} – Finał`, table, {final:true,kind:'mlodzik'});
  else if(label==='Młodziczka') rank=renderRanking(`Ranking – ${label} – Finał`, table, {final:true,kind:'mlodziczka'});
  else rank=renderRanking(`Ranking – ${label} – Finał`, table);
  grid.appendChild(term); grid.appendChild(rank); view.appendChild(grid); return view;
}

// --- widoki (viewRozstaw, viewLigaM, viewLigaF itd.) ---
// [tutaj zostaw swoje renderTermRozstaw, renderTermLigaM, renderTermLigaF, renderTermFinal i viewRozstaw, viewLigaM, viewLigaF]

// --- obsługa zakładek + boot ---
let DATA=null;
function setActive(btn){ document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active')); btn.classList.add('active'); }
function renderView(kind){
  const mount=document.getElementById('view'); mount.innerHTML='';
  if(!DATA) return;
  if(kind==='m_rozstaw1') mount.appendChild(viewRozstaw('Młodzik',DATA.m_rozstaw1||[]));
  else if(kind==='m_rozstaw2') mount.appendChild(viewRozstaw('Młodzik',DATA.m_rozstaw2||[]));
  else if(kind==='m_liga') mount.appendChild(viewLigaM(DATA.m_liga||[]));
  else if(kind==='m_final') mount.appendChild(renderFinalView(DATA.m_final||[],'Młodzik'));
  else if(kind==='f_rozstaw1') mount.appendChild(viewRozstaw('Młodziczka',DATA.f_rozstaw1||[]));
  else if(kind==='f_rozstaw2') mount.appendChild(viewRozstaw('Młodziczka',DATA.f_rozstaw2||[]));
  else if(kind==='f_liga') mount.appendChild(viewLigaF(DATA.f_liga||[]));
  else if(kind==='f_final') mount.appendChild(renderFinalView(DATA.f_final||[],'Młodziczka'));
}
async function boot(){
  try{
    const res=await fetch(WEB_APP_URL,{cache:'no-store'});
    if(!res.ok) throw new Error('HTTP '+res.status);
    DATA=await res.json();
  }catch(err){
    const mount=document.getElementById('view');
    mount.innerHTML=`<div class="card"><div class="card-header"><h2>Błąd</h2></div><div class="card-body"><p class="muted">Nie udało się pobrać danych.<br>Szczegóły: ${err}</p></div></div>`;
    return;
  }
  document.querySelectorAll('.tab-btn').forEach(btn=>btn.addEventListener('click',()=>{ setActive(btn); renderView(btn.dataset.view); }));
  renderView('m_rozstaw1'); // start
}
boot();
</script>
</body>
</html>
